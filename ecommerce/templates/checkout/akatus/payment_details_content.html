{% load currency_filters %}

{% load static i18n %}
<div class="accordion" id="accordion">
    {% if basket.total_incl_tax == 0 %}
        <div class="accordion-group">
            <div class="accordion-heading">
                <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" href="#collapseOne">
                    Grátis
                </a>
            </div>
            <div id="collapseOne" class="accordion-body collapse in">
                <div class="accordion-inner">
                    <form action="{% url 'checkout:preview' %}" class="form-horizontal" method="post">
                        <input type="hidden" name="source-type" value="no-payment" />
                        {% csrf_token %}
                        <div class="pull-left">
                            {% include 'partials/contratos_checkbox.html' %}
                        </div>
                        <button type="submit" data-toggle="tooltip" data-disable-title="Para concluir é necessário aceitar os termos e condições de uso" class="pull-right btn btn-orange">Concluir</button>
                    </form>
                </div>
            </div>
        </div>

    {% else %}
        <div class="accordion-group">
            <div class="accordion-heading">
                <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" href="#collapseOne">
                    Cartão de crédito
                </a>
            </div>
            <div id="collapseOne" class="accordion-body collapse">
                <div class="accordion-inner">
                    <form action="{% url 'checkout:preview' %}" class="form-horizontal" method="post">

                        <div class="row-fluid">
                            {% if total_certificados %}
                                <div class="span6">
                                    <h2>Certificados</h2>

                                    <span class="" style="width: 120px; padding: 3px; padding-bottom: 0; display: inline-block">
                                        <strong style="padding-left: 20px">Parcela</strong>
                                    </span>

                                    <span class="" style="width: 100px; padding: 3px; padding-bottom: 0; display: inline-block">
                                        <strong>Total com juros</strong>
                                    </span>

                                    {% for parcela in parcelas.certificados %}
                                        <label class="radio">
                                            {# Todo: Remove inline CSS #}

                                            <span class="" style="width: 100px; padding: 3px; padding-bottom: 0; display: inline-block">
                                                <input name="certificado_parcela" value="{{ parcela.qtd }}" type="radio" {% if forloop.first %}checked="checked"{% endif %} />
                                                <strong>{{ parcela.qtd }}</strong> x {{ parcela.valor_parcela|currency  }}
                                            </span>
                                            <span class="" style="width: 80px; padding: 3px; padding-bottom: 0; display: inline-block">
                                                {{ parcela.valor_total|currency  }}
                                            </span>
                                            {% if parcela.juros %}
                                                <span>Juros: {{ parcela.juros }}%</span>
                                            {% endif %}

                                        </label>
                                    {% endfor %}
                                </div>
                            {% endif %}
                            {% if total_assinaturas %}
                            <div class="span6" {% if total_certificados %}style="border-left: 1px solid rgb(221, 221, 221); padding-left: 10px;"{% endif %}>
                                <h2>Assinaturas</h2>
                                <label class="radio">
                                    <span class="" style="padding: 3px; padding-bottom: 0; display: inline-block">
                                        <input name="assinatura_parcela" value="1" type="radio" checked="checked" />
                                        {{ parcelas.assinaturas|currency  }} / mês
                                    </span>
                                    {% if parcela.juros %}
                                        <span>Juros: {{ parcela.juros }}%</span>
                                    {% endif %}

                                </label>
                            </div>
                            {% endif %}
                        </div>

                        <hr/>

                        <input type="hidden" name="source-type" value="akatus-creditcard" />
                        <div class="">
                            {% csrf_token %}
                            {% include 'partials/form_fields.html' with form=bankcard_form %}
                            <div class="alert alert-warning">
                                <h4>{% trans "Demo card" %}</h4>
                                <p>{% trans "You can use a magic card number of 4551870000000183 together with an CVV number." %}</p>
                            </div>
                        </div>
                        <div class="pull-left">
                            {% include 'partials/contratos_checkbox.html' %}
                        </div>
                        <button type="submit" data-toggle="tooltip" data-disable-title="Para concluir é necessário aceitar os termos e condições de uso" class="pull-right btn btn-orange">Concluir</button>
                    </form>
                </div>
            </div>
        </div>

        <div class="accordion-group">
            <div class="accordion-heading">
                <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo">
                    Boleto bancário
                </a>
            </div>
            <div id="collapseTwo" class="accordion-body collapse">
                <div class="accordion-inner">
                    <p>Para pagamento por boleto bancário, o banco nos envia uma confirmação em até <strong>dois dias úteis</strong> após o pagamento.</p>
                    <p>Após a confirmação o pedido será liberado para emissão.</p>
                    <p>Ao confirmar o pedido clicando no botão "Finalizar Compra" o seu pedido será concluído e será disponibilizado um link para que você possa visualizar o boleto gerado.</p>

                    <form action="{% url 'checkout:preview' %}" class="form-horizontal" method="post">
                        {% csrf_token %}
                        <input type="hidden" name="source-type" value="akatus-boleto" />
                        <div class="pull-left">
                            {% include 'partials/contratos_checkbox.html' %}
                        </div>
                        <button type="submit" data-toggle="tooltip" data-disable-title="Para concluir é necessário aceitar os termos e condições de uso" class="pull-right btn btn-orange">Concluir</button>
                    </form>
                </div>
            </div>
        </div>
        <div class="accordion-group">
            <div class="accordion-heading">
                <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" href="#collapseThree">
                    Cartão de Débito / Débito em conta
                </a>
            </div>
            <div id="collapseThree" class="accordion-body collapse">
                <div class="accordion-inner">
                    <p>Para pagamento por débito em conta, o banco nos envia uma confirmação em até <strong>dois dias úteis</strong> após o pagamento.</p>
                    <p>Após essa confirmação o pedido é liberado para emissão.</p>
                    <p>Escolha seu banco abaixo, e ao confirmar sua compra, você será encaminhado para uma página do banco, onde deverá fazer o pagamento online.</p>

                    <form action="{% url 'checkout:preview' %}" class="form-inline" method="post">
                        {% csrf_token %}
                        <input type="hidden" name="source-type" value="akatus-debitcard" />
                        <button type="submit" data-toggle="tooltip" data-disable-title="Para concluir é necessário aceitar os termos e condições de uso" class="pull-right btn btn-orange">Concluir</button>

                        <label>
                            <input type="radio" name="banco" value="bb"/>
                            <img src="{% static 'home/img/payment/thumb_bb.gif' %}" alt=""/>
                        </label>

                        <label>
                            <input type="radio" name="banco" value="itau"/>
                            <img src="{% static 'home/img/payment/thumb_itau.gif' %}" alt=""/>
                        </label>

                        <label>
                            <input type="radio" name="banco" value="bradesco"/>
                            <img src="{% static 'home/img/payment/thumb_bradesco.gif' %}" alt=""/>
                        </label>

                        <br><br>

                        <div class="pull-left">
                            {% include 'partials/contratos_checkbox.html' %}
                        </div>
                    </form>
                </div>
            </div>
        </div>
    {% endif %}

</div>